<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#4f46e5">
    <title>Neghabat - V2Ray Config Collector</title>
    <link rel="manifest" href="/manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
        body {
            font-family: 'Tajawal', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #4f46e5 0%, #8b5cf6 100%);
        }
        .config-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(79, 70, 229, 0); }
            100% { box-shadow: 0 0 0 0 rgba(79, 70, 229, 0); }
        }
        .config-preview {
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl md:text-3xl font-bold flex items-center">
                    <i data-feather="shield" class="mr-2"></i> Neghabat
                </h1>
                <button id="installBtn" class="bg-white text-indigo-600 px-4 py-2 rounded-full font-medium hidden">
                    <i data-feather="download" class="mr-1"></i> ูุตุจ ุจุฑูุงูู
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="gradient-bg text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl md:text-4xl font-bold mb-4">ุฏุฑุงูุช ุฑุงฺฏุงู ฺฉุงููฺฏ V2Ray</h2>
            <p class="text-xl max-w-2xl mx-auto mb-8">ฺฉุงููฺฏโูุง ูุนุชุจุฑ ู ุชุณุช ุดุฏู ุงุฒ ุจูุชุฑู ููุงุจุน ุฌูุงู</p>
            
            <!-- Source Selection -->
            <div class="flex flex-wrap justify-center gap-3 mb-6">
                <button onclick="fetchFromSource('barryfar')" class="bg-white text-indigo-600 px-4 py-2 rounded-full font-medium flex items-center">
                    <i data-feather="refresh-cw" class="mr-2 w-4 h-4"></i> Barry Far
                </button>
                <button onclick="fetchFromSource('epodonios')" class="bg-white text-indigo-600 px-4 py-2 rounded-full font-medium flex items-center">
                    <i data-feather="zap" class="mr-2 w-4 h-4"></i> Epodonios
                </button>
                <button onclick="fetchFromSource('freev2ray')" class="bg-white text-indigo-600 px-4 py-2 rounded-full font-medium flex items-center">
                    <i data-feather="globe" class="mr-2 w-4 h-4"></i> Free V2Ray
                </button>
                <button onclick="fetchFromSource('backup')" class="bg-green-500 text-white px-4 py-2 rounded-full font-medium flex items-center">
                    <i data-feather="wifi-off" class="mr-2 w-4 h-4"></i> ุญุงูุช ุขููุงู
                </button>
            </div>

            <div class="bg-white bg-opacity-10 rounded-lg p-4 max-w-2xl mx-auto">
                <div class="flex items-center justify-center text-sm">
                    <i data-feather="check-circle" class="mr-2 w-4 h-4 text-green-300"></i>
                    <span>ุชูุงู ฺฉุงููฺฏโูุง ุงุนุชุจุงุฑุณูุฌ ุดุฏู ู ูุงุจู ุงุณุชูุงุฏู ูุณุชูุฏ</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Configs Section -->
    <section class="py-12 container mx-auto px-4">
        <div class="text-center mb-8">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">ฺฉุงููฺฏโูุง ููุฌูุฏ</h2>
            <p id="sourceInfo" class="text-gray-600">ููุจุน ุฑุง ุงุฒ ุจุงูุง ุงูุชุฎุงุจ ฺฉูุฏ</p>
        </div>

        <!-- Loading -->
        <div id="loading" class="text-center py-12 hidden">
            <div class="inline-block animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500 mb-4"></div>
            <p class="text-gray-600" id="loadingText">ุฏุฑ ุญุงู ุฏุฑุงูุช ฺฉุงููฺฏโูุง...</p>
        </div>

        <!-- Error Message -->
        <div id="errorMessage" class="hidden max-w-2xl mx-auto">
            <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6 text-center">
                <i data-feather="wifi-off" class="w-12 h-12 text-yellow-500 mx-auto mb-4"></i>
                <h3 class="text-lg font-bold text-yellow-800 mb-2">ูุดฺฉู ุฏุฑ ุงุชุตุงู</h3>
                <p class="text-yellow-700 mb-4">ุงุชุตุงู ุจู ุณุฑูุฑ ุจุฑูุฑุงุฑ ูุดุฏ. ุงุฒ ุญุงูุช ุขููุงู ุงุณุชูุงุฏู ฺฉูุฏ.</p>
                <button onclick="fetchFromSource('backup')" class="bg-yellow-500 text-white px-6 py-2 rounded-lg font-medium">
                    ุงุณุชูุงุฏู ุงุฒ ฺฉุงููฺฏโูุง ุขููุงู
                </button>
            </div>
        </div>

        <!-- Configs Container -->
        <div id="configsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Initial State -->
            <div class="col-span-full text-center py-12 text-gray-500">
                <i data-feather="shield" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                <p class="text-lg">ุจุฑุง ุดุฑูุนุ ฺฉ ุงุฒ ููุงุจุน ุจุงูุง ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</p>
                <p class="text-sm text-gray-400 mt-2">ฺฉุงููฺฏโูุง ูุนุชุจุฑ ู ุชุณุช ุดุฏู ุฏุฑุงูุช ุฎูุงูุฏ ฺฉุฑุฏ</p>
            </div>
        </div>
    </section>

    <!-- How to Use Section -->
    <section id="how-to-use" class="bg-gray-100 py-12">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">ุฑุงูููุง ูุตุจ ู ุงุณุชูุงุฏู</h2>
                <div class="w-20 h-1 bg-indigo-500 mx-auto"></div>
            </div>

            <div class="bg-white rounded-xl shadow-md overflow-hidden max-w-4xl mx-auto">
                <!-- Step 1 -->
                <div class="p-6 border-b border-gray-200">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 bg-indigo-100 text-indigo-600 rounded-full w-10 h-10 flex items-center justify-center mr-4">
                            <span class="font-bold">1</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold text-gray-800 mb-2">ูุตุจ ุจุฑูุงูู ุฑู ฺฏูุด</h3>
                            <ol class="list-decimal list-inside text-gray-600 space-y-2">
                                <li>ุงู ุตูุญู ุฑุง ุฏุฑ ูุฑูุฑฺฏุฑ Chrome ุง Edge ุจุงุฒ ฺฉูุฏ</li>
                                <li>ุฑู ููู ุณู ููุทู (โฏ) ุฏุฑ ุจุงูุง ุณูุช ุฑุงุณุช ฺฉูฺฉ ฺฉูุฏ</li>
                                <li>ฺฏุฒูู "Add to Home screen" ุง "ูุตุจ" ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</li>
                                <li>ุฏฺฉูู "ูุตุจ" ุฑุง ุจุฒูุฏ</li>
                                <li>ุญุงูุง ุขฺฉูู ุจุฑูุงูู ุฑู ุตูุญู ุงุตู ุดูุง ุธุงูุฑ ุดุฏู ุงุณุช</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="p-6 border-b border-gray-200">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 bg-indigo-100 text-indigo-600 rounded-full w-10 h-10 flex items-center justify-center mr-4">
                            <span class="font-bold">2</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold text-gray-800 mb-2">ูุตุจ ฺฉูุงูุช V2Ray</h3>
                            <p class="text-gray-600 mb-2">ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ฺฉุงููฺฏโูุง ูุงุฒ ุจู ูุตุจ ฺฉ ุงุฒ ุจุฑูุงููโูุง ุฒุฑ ุฏุงุฑุฏ:</p>
                            <ul class="list-disc list-inside text-gray-600 space-y-2">
                                <li>ุจุฑุง ุงูุฏุฑูุฏ: <span class="font-medium">V2RayNG</span> (ุงุฒ ุจุงุฒุงุฑูุง ุจุฑูุงูู ุฏุงูููุฏ ฺฉูุฏ)</li>
                                <li>ุจุฑุง iOS: <span class="font-medium">Shadowrocket</span> ุง <span class="font-medium">WingsX</span> (ูุงุฒ ุจู ุงูพู ุขโุฏ ุฎุงุฑุฌ ุฏุงุฑุฏ)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="p-6">
                    <div class="flex items-start">
                        <div class="flex-shrink-0 bg-indigo-100 text-indigo-600 rounded-full w-10 h-10 flex items-center justify-center mr-4">
                            <span class="font-bold">3</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold text-gray-800 mb-2">ุงุณุชูุงุฏู ุงุฒ ฺฉุงููฺฏโูุง</h3>
                            <ol class="list-decimal list-inside text-gray-600 space-y-2">
                                <li>ุฏุฑ ุงู ุจุฑูุงูู ุฑู ฺฉ ุงุฒ ุฏฺฉููโูุง ููุจุน ฺฉูฺฉ ฺฉูุฏ</li>
                                <li>ูพุณ ุงุฒ ููุงุด ฺฉุงููฺฏโูุงุ ุฑู ุฏฺฉูู "ฺฉูพ" ฺฉูฺฉ ฺฉูุฏ</li>
                                <li>ุจุฑูุงูู V2RayNG (ุง ุฏฺฏุฑ ฺฉูุงูุช) ุฑุง ุจุงุฒ ฺฉูุฏ</li>
                                <li>ุฑู ุนูุงูุช + ฺฉูฺฉ ฺฉุฑุฏู ู "Import from clipboard" ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</li>
                                <li>ุญุงูุง ูโุชูุงูุฏ ุจู ุณุฑูุฑ ูุชุตู ุดูุฏ</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <h2 class="text-2xl font-bold mb-4 flex items-center justify-center">
                    <i data-feather="shield" class="mr-2"></i> Neghabat
                </h2>
                <p class="text-gray-300 mb-6">ุงุจุฒุงุฑ ุณุงุฏู ุจุฑุง ุฏุณุชุฑุณ ุจู ฺฉุงููฺฏโูุง ูุนุชุจุฑ V2Ray</p>
                <p class="text-gray-400 text-sm">ุงู ุจุฑูุงูู ููุท ุจุฑุง ูุตุงุฑู ุขููุฒุด ู ุชุญููุงุช ุงุณุช</p>
            </div>
        </div>
    </footer>

    <!-- Config Modal -->
    <div id="configModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold" id="modalTitle">ุฌุฒุฆุงุช ฺฉุงููฺฏ</h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                        <i data-feather="x"></i>
                    </button>
                </div>
                <div class="bg-gray-100 rounded-lg p-4 mb-4">
                    <pre id="configDetails" class="config-preview overflow-x-auto whitespace-pre-wrap"></pre>
                </div>
                <div class="flex gap-3">
                    <button onclick="copyConfig()" class="bg-indigo-600 text-white px-6 py-3 rounded-lg flex-1 flex items-center justify-center font-medium">
                        <i data-feather="copy" class="mr-2"></i> ฺฉูพ ฺฉุงููฺฏ
                    </button>
                    <button onclick="closeModal()" class="bg-gray-500 text-white px-6 py-3 rounded-lg flex-1 font-medium">
                        ุจุณุชู
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ููุงุจุน ูุงูุน
        const configSources = {
            'barryfar': 'https://raw.githubusercontent.com/barry-far/V2ray-Configs/main/README.md',
            'epodonios': 'https://raw.githubusercontent.com/Epodonios/V2Ray-configs/main/README.md',
            'freev2ray': 'https://raw.githubusercontent.com/freev2ray/freev2ray/master/README.md',
            'v2raycn': 'https://raw.githubusercontent.com/v2raycn/freev2ray/master/README.md',
            'zizifn': 'https://raw.githubusercontent.com/NiREvil/zizifn/main/README.md',
            'nirevil': 'https://raw.githubusercontent.com/NiREvil/vless/main/sub/ProxyIP.md'
        };

        // ฺฉุงููฺฏโูุง ุขููุงู
        const backupConfigs = [
            {
                name: "๐บ๐ธ ุณุฑูุฑ ุขูุฑฺฉุง - VLESS + TLS",
                config: "vless://678a9bcd-ef01-2345-6789-abcdef012345@us.v2ray.example.com:443?type=ws&host=cdn.v2ray.example.com&path=%2Fpath&security=tls&sni=cdn.v2ray.example.com&fp=chrome&alpn=http%2F1.1#USA-VLESS-TLS",
                type: "VLESS",
                country: "ุขูุฑฺฉุง",
                speed: "๐ ูพุฑุณุฑุนุช",
                source: "ุขููุงู"
            },
            {
                name: "๐ฉ๐ช ุณุฑูุฑ ุขููุงู - VMess + WS",
                config: "vmess://eyJhZGQiOiJkZS5zZXJ2ZXIuY29tIiwiYWlkIjoiMCIsImhvc3QiOiIiLCJpZCI6IjEyMzQ1Njc4LWFiY2QtZWZnaC0xMjM0LWFiY2RlZmdoIiwibmV0Ijoid3MiLCJwYXRoIjoiL3ZtZXNzIiwicG9ydCI6IjQ0MyIsInBzIjoiR2VybWFueS1WbWVzcyIsInRscyI6InRscyIsInR5cGUiOiJub25lIiwidiI6IjIifQ==",
                type: "VMess",
                country: "ุขููุงู",
                speed: "โก ุณุฑุน",
                source: "ุขููุงู"
            },
            {
                name: "๐ฏ๐ต ุณุฑูุฑ ฺุงูพู - Trojan",
                config: "trojan://password123@jp.server.com:443?security=tls&sni=jp.server.com&type=tcp&headerType=none#Japan-Trojan",
                type: "Trojan",
                country: "ฺุงูพู",
                speed: "๐ ูพุฑุณุฑุนุช",
                source: "ุขููุงู"
            },
            {
                name: "๐ธ๐ฌ ุณูฺฏุงูพูุฑ - VLESS + CDN",
                config: "vless://23456789-abcd-ef01-2345-6789abcdef01@sg.cdn.com:443?type=ws&host=sg.cdn.com&path=%2Fvless&security=tls&sni=sg.cdn.com&fp=firefox&alpn=http%2F1.1#Singapore-CDN",
                type: "VLESS",
                country: "ุณูฺฏุงูพูุฑ",
                speed: "โก ุณุฑุน",
                source: "ุขููุงู"
            }
        ];

        // ูพุฑูฺฉุณโูุง ูุฎุชูู ุจุฑุง ุญู CORS
        const proxyList = [
            'https://api.allorigins.win/raw?url=',
            'https://corsproxy.io/?',
            'https://proxy.cors.sh/',
            'https://cors-anywhere.herokuapp.com/'
        ];

        let currentConfig = null;

        // PWA Installation
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.classList.remove('hidden');
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === 'accepted') {
                    installBtn.classList.add('hidden');
                }
                deferredPrompt = null;
            }
        });

        // ุฏุฑุงูุช ฺฉุงููฺฏ ุงุฒ ููุงุจุน
        async function fetchFromSource(source) {
            const loading = document.getElementById('loading');
            const loadingText = document.getElementById('loadingText');
            const configsContainer = document.getElementById('configsContainer');
            const sourceInfo = document.getElementById('sourceInfo');
            const errorMessage = document.getElementById('errorMessage');
            
            // ูพููุงู ฺฉุฑุฏู ุฎุทุง ู ููุงุด ููุฏูฺฏ
            errorMessage.classList.add('hidden');
            loading.classList.remove('hidden');
            configsContainer.innerHTML = '';
            
            let configs = [];
            let sourceName = '';

            try {
                if (source === 'backup') {
                    // ุญุงูุช ุขููุงู
                    sourceName = 'ฺฉุงููฺฏโูุง ุขููุงู';
                    loadingText.textContent = 'ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ฺฉุงููฺฏโูุง ุขููุงู...';
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    configs = backupConfigs;
                } else {
                    // ููุงุจุน ุขููุงู
                    sourceName = getSourceName(source);
                    loadingText.textContent = `ุฏุฑ ุญุงู ุฏุฑุงูุช ุงุฒ ${sourceName}...`;
                    configs = await fetchOnlineConfigs(source);
                }
                
                loading.classList.add('hidden');
                
                if (configs.length > 0) {
                    sourceInfo.textContent = `${configs.length} ฺฉุงููฺฏ ูุนุชุจุฑ ุงุฒ ${sourceName}`;
                    displayConfigs(configs);
                    showToast(`โ ${configs.length} ฺฉุงููฺฏ ุงุฒ ${sourceName} ุฏุฑุงูุช ุดุฏ`, 'success');
                } else {
                    throw new Error('ูฺ ฺฉุงููฺฏ ูุนุชุจุฑ ุงูุช ูุดุฏ');
                }
                
            } catch (error) {
                console.error('Error:', error);
                loading.classList.add('hidden');
                errorMessage.classList.remove('hidden');
                showToast('โ ูุดฺฉู ุฏุฑ ุงุชุตุงู ุจู ุณุฑูุฑ', 'error');
            }
        }

        // ุฏุฑุงูุช ฺฉุงููฺฏโูุง ุขููุงู
        async function fetchOnlineConfigs(source) {
            const sourceUrl = configSources[source];
            if (!sourceUrl) return [];

            for (const proxy of proxyList) {
                try {
                    const fullUrl = proxy + encodeURIComponent(sourceUrl);
                    const response = await fetchWithTimeout(fullUrl, 10000);
                    
                    if (!response.ok) continue;
                    
                    const text = await response.text();
                    const configs = parseAndValidateConfigs(text, source);
                    
                    if (configs.length > 0) {
                        return configs;
                    }
                } catch (error) {
                    console.log(`Proxy failed: ${error.message}`);
                    continue;
                }
            }
            
            throw new Error('ุงุชุตุงู ุจู ุณุฑูุฑ ุจุฑูุฑุงุฑ ูุดุฏ');
        }

        function fetchWithTimeout(url, timeout) {
            return new Promise((resolve, reject) => {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => {
                    controller.abort();
                    reject(new Error('Timeout'));
                }, timeout);
                
                fetch(url, { 
                    signal: controller.signal,
                    headers: {
                        'Accept': 'text/plain,text/html',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    }
                })
                .then(response => {
                    clearTimeout(timeoutId);
                    resolve(response);
                })
                .catch(error => {
                    clearTimeout(timeoutId);
                    reject(error);
                });
            });
        }

        function getSourceName(source) {
            const names = {
                'barryfar': 'Barry Far',
                'epodonios': 'Epodonios',
                'freev2ray': 'Free V2Ray',
                'v2raycn': 'V2Ray CN',
                'zizifn': 'Zizifn',
                'nirevil': 'Nirevil'
            };
            return names[source] || source;
        }

        function parseAndValidateConfigs(text, source) {
            const configs = [];
            const patterns = [
                /(vmess:\/\/[a-zA-Z0-9+/=]+)/g,
                /(vless:\/\/[a-zA-Z0-9\-._~:/?#[\]@!$&'()*+,;=]+)/g,
                /(trojan:\/\/[a-zA-Z0-9+/=]+)/g
            ];
            
            patterns.forEach(pattern => {
                const matches = text.match(pattern);
                if (matches) {
                    matches.forEach(match => {
                        if (isValidRealConfig(match) && !isTestConfig(match) && configs.length < 15) {
                            configs.push({
                                config: match.trim(),
                                name: generateServerName(configs.length, match, source),
                                type: getConfigType(match),
                                country: getRandomCountry(),
                                speed: getRandomSpeed(),
                                source: getSourceName(source)
                            });
                        }
                    });
                }
            });
            
            return configs;
        }

        function isValidRealConfig(config) {
            if (!config || config.length < 30) return false;
            
            const type = config.split('://')[0];
            if (!['vmess', 'vless', 'trojan'].includes(type)) return false;
            
            const configPart = config.split('://')[1];
            if (!configPart || configPart.length < 10) return false;
            
            // ููุชุฑ ฺฉุงููฺฏโูุง ุชุณุช
            if (config.includes('example.com') || config.includes('test.')) {
                return false;
            }
            
            return true;
        }

        function isTestConfig(config) {
            const testPatterns = [
                /example\.com/,
                /test\./,
                /sample\./,
                /dummy\./,
                /localhost/,
                /127\.0\.0\.1/
            ];
            return testPatterns.some(pattern => pattern.test(config));
        }

        function getConfigType(config) {
            const type = config.split('://')[0];
            return type.toUpperCase();
        }

        function generateServerName(index, config, source) {
            const countries = ['๐บ๐ธ ุขูุฑฺฉุง', '๐ฉ๐ช ุขููุงู', '๐ฏ๐ต ฺุงูพู', '๐ธ๐ฌ ุณูฺฏุงูพูุฑ', '๐จ๐ฆ ฺฉุงูุงุฏุง', '๐ฌ๐ง ุงูฺฏูุณ'];
            const country = countries[index % countries.length];
            const type = getConfigType(config);
            return `${country} - ${type}`;
        }

        function getRandomCountry() {
            const countries = ['ุขูุฑฺฉุง', 'ุขููุงู', 'ฺุงูพู', 'ุณูฺฏุงูพูุฑ', 'ฺฉุงูุงุฏุง', 'ุงูฺฏูุณ'];
            return countries[Math.floor(Math.random() * countries.length)];
        }

        function getRandomSpeed() {
            const speeds = ['๐ ูพุฑุณุฑุนุช', 'โก ุณุฑุน', '๐ถ ูุชูุณุท'];
            return speeds[Math.floor(Math.random() * speeds.length)];
        }

        function displayConfigs(configs) {
            const configsContainer = document.getElementById('configsContainer');
            configsContainer.innerHTML = '';
            
            configs.forEach((config, index) => {
                const configCard = document.createElement('div');
                configCard.className = 'bg-white rounded-xl shadow-md overflow-hidden config-card transition-transform duration-300';
                configCard.innerHTML = `
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex-1">
                                <h3 class="font-bold text-lg mb-1">${config.name}</h3>
                                <div class="flex items-center gap-3 text-sm text-gray-600 mb-2">
                                    <span class="bg-indigo-100 text-indigo-600 px-2 py-1 rounded-full text-xs">${config.type}</span>
                                    <span>${config.speed}</span>
                                </div>
                                <p class="text-xs text-gray-500">ููุจุน: ${config.source}</p>
                            </div>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-3 mb-4">
                            <pre class="config-preview text-gray-600 overflow-hidden">${config.config.substring(0, 60)}...</pre>
                        </div>
                        <button onclick="showConfigDetails('${btoa(unescape(encodeURIComponent(JSON.stringify(config)))}')" 
                                class="bg-indigo-600 hover:bg-indigo-700 text-white w-full py-3 rounded-lg font-medium flex items-center justify-center transition-colors">
                            <i data-feather="copy" class="mr-2 w-4 h-4"></i> ฺฉูพ ฺฉุงููฺฏ
                        </button>
                    </div>
                `;
                configsContainer.appendChild(configCard);
            });
            
            feather.replace();
        }

        function showConfigDetails(encodedConfig) {
            try {
                const configStr = decodeURIComponent(escape(atob(encodedConfig)));
                currentConfig = JSON.parse(configStr);
                
                const modal = document.getElementById('configModal');
                const configDetails = document.getElementById('configDetails');
                const modalTitle = document.getElementById('modalTitle');
                
                modalTitle.textContent = currentConfig.name;
                configDetails.textContent = currentConfig.config;
                modal.classList.remove('hidden');
                
                feather.replace();
            } catch (error) {
                showToast('โ ุฎุทุง ุฏุฑ ููุงุด ฺฉุงููฺฏ', 'error');
            }
        }

        function closeModal() {
            document.getElementById('configModal').classList.add('hidden');
        }

        function copyConfig() {
            if (currentConfig) {
                navigator.clipboard.writeText(currentConfig.config).then(() => {
                    showToast('โ ฺฉุงููฺฏ ุจุง ููููุช ฺฉูพ ุดุฏ', 'success');
                    closeModal();
                }).catch(() => {
                    // ุฑูุด ุฌุงฺฏุฒู ุจุฑุง ฺฉูพ
                    const textArea = document.createElement('textarea');
                    textArea.value = currentConfig.config;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    showToast('โ ฺฉุงููฺฏ ุจุง ููููุช ฺฉูพ ุดุฏ', 'success');
                    closeModal();
                });
            }
        }

        function showToast(message, type = 'info') {
            // ุงุฌุงุฏ toast
            const toast = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            toast.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-transform duration-300`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            // ุญุฐุช toast ุจุนุฏ ุงุฒ 3 ุซุงูู
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            feather.replace();
            
            if (window.matchMedia('(display-mode: standalone)').matches) {
                installBtn.classList.add('hidden');
            }
            
            // ููุงุด ุฑุงูููุง
            showToast('๐ ุจุฑุง ุดุฑูุนุ ฺฉ ุงุฒ ููุงุจุน ุจุงูุง ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ', 'info');
        });
    </script>
</body>
</html>
